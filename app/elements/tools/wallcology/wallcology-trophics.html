<!DOCTYPE html>
<html>
<head>
  <!-- 	<link href="../bower_components/iron-input/iron-input.html" rel="import"> -->
  <!-- 	<link href="../bower_components/paper-button/paper-button.html" rel="import"> -->
</head>

<dom-module id="wallcology-trophics" attributes="tags">
  <style>

    :host {
      --paper-input-container-color: black;
      --paper-input-container-focus-color: black;
      --paper-input-container-input-color: black;
      --paper-menu-focused-item: {
        font-weight: bold;
      };
    }

    paper-item {
      --paper-item: {
        cursor: pointer;
      };
    }

    .red {
      background-color: var(--paper-red-500);
    }

    .pink {
      background-color: var(--paper-pink-500);
    }

    .orange {
      background-color: var(--paper-orange-500);
    }

    .blue {
      background-color: var(--paper-light-blue-200);
    }

    .purple {
      background-color: var(--paper-purple-200);
    }

    .white {
      background-color: white;
    }


    .paper-title {
      /*background-color: orange;*/
      height: 100%;
      margin-top: 2px;
      padding: 6px;
    }

    .paper-text {
      background-color: var(--paper-grey-50);
      width: 300px;
    }



    .filter-section {
      height: 100%;
      width: 100%;
      padding: 5px 0px 0px 5px;
      margin: 0px 0px 0px 5px;
    }



    .avatar {
      display: inline-block;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      overflow: hidden;
      background: #ccc;

    }

    .list {
      /*display: inline-block;*/
      width: 100%;
      margin: 0px;
      padding: 0px;
    }


    .vcontainer {
      @apply(--layout-vertical);
    }

    .hcontainer {
      @apply(--layout-horizontal);
    }

    .hcentercontainer {
      @apply(--layout-horizontal);
      @apply(--layout-center-justified);
    }

    .zeroed {
      margin: 0px;
      padding: 0px;
    }

    .container {
      @apply(--layout-vertical);
    }
    .flexchild {
      @apply(--layout-flex);
    }

    .paper-section {
      height: 100%;
      width: 100px;
      padding: 5px;
    }

    .test {
      padding: 0px;
      margin: 0px;
      height: 100%;
    }

    .s1 {
      padding: 0px;
    }

    .trophic-section {
      display: inline-block;
      height: 100%;
      /*width: 100%;*/
      padding: 5px 10px 0px 10px;
      /*margin: 0px 0px 5px 0px;*/
      @apply(--layout-center-justified);
    }

  </style>
  <template>
    <iron-ajax id="userAjax"
               contentType="application/json"
               url="http://beta.json-generator.com/api/json/get/VJqMxIii"
               params=""
               handle-as="json"
               on-response="handleUserResponse" loading="{{loading}}" method="GET" auto verbose>

    </iron-ajax>
    <iron-ajax id="trophicAjax"
               contentType="application/json"
               url="http://beta.json-generator.com/api/json/get/V1jyL-w3"
               params=""
               handle-as="json"
               on-response="handlePopulationsResponse" loading="{{loading}}" method="GET" auto verbose>

    </iron-ajax>

    <!--<grid-element ghi gho="50px" gvi gvo="5px" gs="25px">-->
      <!--<grid-col><div class="red">ONE</div></grid-col>-->
      <!--<grid-col><div class="orange">TWO</div></grid-col>-->
      <!--<grid-col><div class="blue">THREE</div></grid-col>-->
    <!--</grid-element>-->

    <div></div>

    <iron-grid class="test">

      <div class="s1 test">
          <div class="hcentercontainer"><h3>Filter</h3></div>

          <div class="white">
            <paper-menu id="menu" class="list" selected="{{selectedIndex}}">
              <template  is="dom-repeat" id="filterList" items="{{users}}">
                <paper-item id="{{item.name}}" class="zeroed hcentercontainer">
                  <div><span>{{toUpperCase(item.name)}}</span></div>
                </paper-item>
              </template>
            </paper-menu>
          </div>
      </div>

      <div class="s11 container ">
        <div class="hcentercontainer"><h3>Trophic</h3></div>


        <div class="hcentercontainer"><h3>Trophic</h3>



        </div>
      </div>
    </iron-grid>

    <!--<paper-material elevation="0" class="vcontainer paper-title">-->
      <!--<h2 class="spacer title">Trophics for <span>{{currentHabitat.name}}</span></h2>-->


      <!--<div class="hcontainer">-->
        <!--<wallcology-bugselector selected-bugs="{{selectedBugs}}" current-habitat="{{currentHabitat}}"></wallcology-bugselector>-->
      <!--</div>-->

 <!-- -->
      <!--&lt;!&ndash;out section&ndash;&gt;-->
      <!--&lt;!&ndash;<div class="hcontainer test red">&ndash;&gt;-->



          <!--<div class="hcontainer">-->
          <!-- -->
            <!--<paper-material elevation="1" class="trophic-section blue">-->
              <!--<div class="container"></div>-->
              <!--<div><h3>Trophics</h3></div>-->
              <!--<div class="flexchild zeroed">-->
                <!--<paper-textarea class="paper-text" label="Your claim..." label="at most 10 letters"  char-counter rows="8" colspan="8"></paper-textarea></paper-textarea>-->
              <!--</div>-->
            <!--</paper-material>-->
          <!--</div>-->
        <!--</div>-->
        <!--<div class="spacer">-->
          <!--<paper-material elevation="1" class="paper-section vcontainer">-->
            <!--<h3>Trophics</h3>-->
            <!--<div>-->
              <!--<paper-textarea class="paper-text" label="Your claim..." label="at most 10 letters"  char-counter rows="8"></paper-textarea></paper-textarea>-->
            <!--</div>-->
          <!--</paper-material>-->
        <!--</div>-->
        <!--<div class="spacer">-->
          <!--<paper-material elevation="1" class="paper-section vcontainer">-->
            <!--<h3>Justification</h3>-->
            <!--<div>-->
              <!--<paper-textarea class="paper-text" label="Your claim..." label="at most 10 letters"  char-counter rows="8"></paper-textarea></paper-textarea>-->
            <!--</div>-->
          <!--</paper-material>-->
        <!--</div>-->

    <!--</paper-material>-->
  </template>

  <script>
    // element registration
    Polymer({
      is: 'wallcology-trophics',

      // add properties and methods on the element's prototype
      properties: {
        // declare properties for the element's public API

        currentHabitat: {
          type: Object,
          notify: true,
          observer: 'currentHabitatChanged'
        },
        selectedBugs: {
          type: Array,
          notify: true,
          value: []
        },
        selectedIndex: {
          type: Number,
          value: 0,
          observer: '_selectedIndexChanged'
        },
        users: {
          type: Array,
          notify: true,
          value: []
        },
        currentTrophics: {
          type: Array,
          notify: true,
          value: []
        },
        populations: {
          type: Array,
          notify: true,
          value: []
        },
        tags: {
          type: Array,
          notify: true,
          value: []
        }
      },
      currentHabitatChanged: function (newValue, oldValue) {
        //  this.$.mainCard.heading = 'Species for ' + this.currentHabitat.name;
        //console.log('species tab oldValue: ' + oldValue + ' newValue: ' + newValue);
      },
      handleUserResponse: function(e) {
        this.users = e.target.lastResponse;
      },
      handlePopulationsResponse: function(e) {
        this.populations = e.target.lastResponse;
      },
      _selectedIndexChanged: function(newValue, oldValue) {
        console.log('You selected item #' + newValue + '.');
        console.log('Before, you had item #' + oldValue + ' selected.');

        if( this.users !== undefined ) {
          this.currentTrophics = [];
          var selectedUser = this.users[newValue];

          for( var i = 0; i < this.populations.length; i++) {
            var population = this.populations[i];
            if( population.name === selectedUser.name ) {
              this.push('currentTrophics', population.trophics);
              console.log(this.currentTrophics);
            }
          }
          this.populations.forEach(function(entry) {
            if( entry.name === selectedUser.name ) {

            }
          });
        }



      },
      toUpperCase: function(someString) {
        return someString.toUpperCase();
      },
      ready: function () {
        this.currentHabitat = {};
        this.selectedBugs = [];
        this.tags = [];
        this.users = [];
        this.populations = [];
        this.currentTrophics = [];
        console.log('TROPICS is READY');
      },
    });
  </script>
</dom-module>
